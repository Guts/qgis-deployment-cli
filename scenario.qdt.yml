# This is a sample of a YAML file for the QGIS Deployment Toolbelt scenario.
# For now, it's more a roadmap than a real description of what it's implemented.

metadata:
  title: "Sample scenario of QGIS Deployment Toolbelt"
  id: development-scenario
  description: >-
    This is an example a scenario YAML file for the QGIS Deployment Toolbelt to
    demonstrate capabilities.

# Toolbelt settings
settings:
  LOCAL_QDT_WORKDIR: ~/.cache/qgis-deployment-toolbelt/Oslandia/
  QGIS_EXE_PATH:
    linux: /usr/bin/qgis
    mac: /usr/bin/qgis
    windows: "%PROGRAMFILES%/QGIS/3_22/bin/qgis-bin.exe"
  SCENARIO_VALIDATION: true

# Deployment workflow, step by step
steps:
  - name: Download profiles from remote git repository
    uses: qprofiles-manager
    with:
      action: download
      source: https://gitlab.com/Oslandia/qgis/profils_qgis_fr_2022.git
      protocol: git
      local_destination: ~/.cache/qgis-deployment-toolbelt/Oslandia/
      sync_mode: overwrite
      branch: main

  - name: Download plugins
    uses: qplugins-downloader
    with:
      force: false
      threads: 5

  - name: Synchronize plugins
    uses: qplugins-synchronizer
    with:
      action: create_or_restore
      profile_ref: downloaded
      source: ~/.cache/qgis-deployment-toolbelt/plugins


  - name: Create shortcuts for profiles
    uses: shortcuts-manager
    with:
      action: create_or_restore
      include:
        - profile: conf_qgis_fr
          label: "QGIS - Conf QGIS FR"
          additional_arguments: "--noversioncheck"
          desktop: false
          start_menu: true
          icon: "qgis_icon.ico"
        - profile: Oslandia
          label: "QGIS - Profil Oslandia"
          additional_arguments: "--noversioncheck"
          desktop: true
          start_menu: true
          icon: "qgis_icon_oslandia.ico"

  - name: Set splash screen
    uses: splash-screen-manager
    with:
      action: create_or_restore
      strict: false
